<div class="bg-white rounded-lg shadow p-6">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-bold">جميع الحسابات</h2>
        <button onclick="loadPage('add-account')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
            إضافة حساب جديد
        </button>
    </div>

    <div class="overflow-x-auto">
        <table class="min-w-full bg-white">
            <thead>
                <tr class="bg-gray-100">
                    <th class="py-2 px-4 border">الكود</th>
                    <th class="py-2 px-4 border">اسم الحساب</th>
                    <th class="py-2 px-4 border">النوع</th>
                    <th class="py-2 px-4 border">الرصيد الحالي</th>
                    <th class="py-2 px-4 border">الحالة</th>
                    <th class="py-2 px-4 border">الإجراءات</th>
                </tr>
            </thead>
            <tbody id="accounts-table-body">
                <!-- سيتم ملؤها بالبيانات من خلال JavaScript -->
            </tbody>
        </table>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/getAccounts.php')
        .then(response => response.json())
        .then(data => {
            const tableBody = document.getElementById('accounts-table-body');
            tableBody.innerHTML = '';

            data.forEach(account => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="py-2 px-4 border text-center">${account.code}</td>
                    <td class="py-2 px-4 border">${account.name}</td>
                    <td class="py-2 px-4 border text-center">${account.type_name}</td>
                    <td class="py-2 px-4 border text-center">${account.current_balance} ر.س</td>
                    <td class="py-2 px-4 border text-center">
                        <span class="px-2 py-1 rounded ${account.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${account.status === 'active' ? 'نشط' : 'غير نشط'}
                        </span>
                    </td>
                    <td class="py-2 px-4 border text-center">
                        <button onclick="viewAccountDetails(${account.id})" class="text-blue-600 hover:text-blue-800 mx-1">عرض</button>
                        <button class="text-yellow-600 hover:text-yellow-800 mx-1">تعديل</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        });
});

function viewAccountDetails(accountId) {
    fetch(/api/getAccountDetails.php?id=${accountId})
        .then(response => response.json())
        .then(data => {
            alert(تفاصيل الحساب:\nالاسم: ${data.name}\nالكود: ${data.code}\nالرصيد: ${data.current_balance} ر.س);
        });
}
</script>
